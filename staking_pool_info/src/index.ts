import express from "express";
import { Db, MongoClient } from 'mongodb'
import { RequestHandler } from "./requesthandler";

const app = new RequestHandler();

app.init();
app.get();
// function getTransactions(data: { from: number }) {
//   web3.getTxsv2({ from: data.from }).then((res) => {
//     db.insertTransaction(res.txs).then(_ => {
//       console.log("Indexd block", res.lastblock, "Max block", res.maxblock)
//       if (res.lastblock < res.maxblock) {
//         db.updateLastBlock({ "block": res.lastblock })
//         getTransactions({ from: res.lastblock + 1 });
//       }
//     })
//     .catch(_ => {
//       getTransactions({ from: data.from + 1 });
//     })
//   })
//   .catch(_ => {
//     getTransactions({ from: data.from + 1 });
//   })
// }

// db.initDb().then(_ => {
//   db.getLastBlock().then(from => {
//     console.log("Last block", from)
//     getTransactions({ from });
//   })

//   // {
//   //     blockHash: '0x5ceb5df1b0aed884cf2d57eb75de35fbeffb8930f08dedb88c7ad33012a70a7a',
//   //     blockNumber: 12956325,
//   //     from: '0xBbaE94f099C428788Bd950461C347406C35747Ee',
//   //     gas: 251558,
//   //     gasPrice: '32000001459',
//   //     hash: '0xe695e287cc84ebdbaaccb32797980e7cbd97c94f1b8d2fc91321ec57c9994328',
//   //     input: '0x993e1c42000000000000000000000000000000000000000000000000000000000006d908000000000000000000000000bbae94f099c428788bd950461c347406c35747ee000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000000000000000000000000000000576c9e4578bc00000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000014a01bd77f4dd908b34af4ef902c92b0f40e1fb825871298874b732b5cb3cd0edd0336da7b18d950165cedbc9a1bffcfbe6373cb2f0220d1402f809e6a1be8e35261e1b014a43c0aff7b00cad3fac24891d9f03b7b79c7d3a4e3b24f5c0635d97c70c93362372c06adb21154a9a81061912cbe6458bf619df531a2e92d300ad45526785de1b0138c5e5883a443e721508e2f3d4f431927cc8adf5f29ad11f100a4d206267aa626cf682fc857f10d1637ec5ed9d6e663f1d0bbcbb3666573ffd0831fc9684d2b31b0130a13f5adfda0b512934075ffd6042598ffd697b63352e56df6e01d525b4a6e802b10c37136edfe5ca6e96e5573abf60ff43f69c34383661edcba96c9da81ec81c01f97cc8b7c080317141435220ea17bf1c91600addbb25ae3c6daafe409dad292d2bfa0b6b9c748f1523839edc58ab097ac9c514b6534627994113ea6ea84c46ed1c00000000000000000000000000000000000000000000',
//   //     nonce: 40,
//   //     r: '0x17cec1edf1083820cdee6b4835a612cf16174498ca7dadb4136a10786893582f',
//   //     s: '0xe6979c1089d63881dce4e2a94833cf600f746b587a8cce69db5079bde6e960c',
//   //     to: '0x1A2a1c938CE3eC39b6D47113c7955bAa9DD454F2',
//   //     transactionIndex: 456,
//   //     type: 0,
//   //     v: '0x25',
//   //     value: '0'
//   //   }
//   // 0x993e1c42000000000000000000000000000000000000000000000000000000000006d908000000000000000000000000bbae94f099c428788bd950461c347406c35747ee000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000000000000000000000000000000576c9e4578bc00000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000014a01bd77f4dd908b34af4ef902c92b0f40e1fb825871298874b732b5cb3cd0edd0336da7b18d950165cedbc9a1bffcfbe6373cb2f0220d1402f809e6a1be8e35261e1b014a43c0aff7b00cad3fac24891d9f03b7b79c7d3a4e3b24f5c0635d97c70c93362372c06adb21154a9a81061912cbe6458bf619df531a2e92d300ad45526785de1b0138c5e5883a443e721508e2f3d4f431927cc8adf5f29ad11f100a4d206267aa626cf682fc857f10d1637ec5ed9d6e663f1d0bbcbb3666573ffd0831fc9684d2b31b0130a13f5adfda0b512934075ffd6042598ffd697b63352e56df6e01d525b4a6e802b10c37136edfe5ca6e96e5573abf60ff43f69c34383661edcba96c9da81ec81c01f97cc8b7c080317141435220ea17bf1c91600addbb25ae3c6daafe409dad292d2bfa0b6b9c748f1523839edc58ab097ac9c514b6534627994113ea6ea84c46ed1c00000000000000000000000000000000000000000000
// })
